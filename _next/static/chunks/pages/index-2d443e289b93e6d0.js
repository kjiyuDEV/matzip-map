(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3262)}])},3262:function(e,a,n){"use strict";n.r(a),n.d(a,{__N_SSG:function(){return O},default:function(){return M}});var t=n(5893),s=n(5675),i=n.n(s),r=n(7294),o=n(5121),l=n(5007),c=n(4471);let p=e=>{let{setSearchInput:a,searchInput:n}=e,s=(0,l.I0)(),r=async()=>{if(!n||""===n.trim())return alert("검색이 유효하지 않아요");let e=await o.Z.get("https://t1427jw7i2.execute-api.us-east-1.amazonaws.com/default/navermap",{params:{key:n}}),a=JSON.parse(e.data);if(console.log(a.items,"<item"),s({type:c.w.SET_SEARCH_LIST,list:a.items}),s({type:c.w.SLIDE_MODAL_OPEN,content:"searchList"}),0===a.items.length)return alert("검색이 유효하지 않아요");naver.maps.Service.geocode({query:a.items[0].roadAddress},(e,a)=>{if(e!==naver.maps.Service.Status.OK)return alert("Something wrong!");let n=a.v2.addresses;console.log(n,"<zoom"),console.log(Number(n[0].y)-.5),s({type:c.w.SET_ADDRESS_ZOOM,zoom:{x:Number(n[0].x),y:Number(n[0].y)}})})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"header",children:[(0,t.jsx)(i(),{src:"/img/logo.png",alt:"logo image",className:"logo",width:100,height:100}),(0,t.jsxs)("div",{className:"input-wrap",children:[(0,t.jsx)("input",{className:"search-input",placeholder:"상호명을 검색해주세요",onChange:e=>a(e.target.value),value:n}),(0,t.jsx)("button",{className:"search-button",onClick:r,children:"검색"})]})]})})};var m=n(7478),d=n.n(m);let u=()=>{let e=(0,l.I0)(),{zoom:a,searchList:n,markerList:s,slideModal:i}=(0,l.v9)(e=>(console.log(e),{zoom:e.search.zoom,searchList:e.search.list,markerList:e.marker.list,slideModal:e.menu.slideModal})),p=(0,r.useRef)(null),m=(0,r.useRef)(null),[u,v]=(0,r.useState)([]),[_,w]=(0,r.useState)([]),[h,x]=(0,r.useState)(null),[g,j]=(0,r.useState)([]),S=(0,r.useRef)(null),y=(a,n)=>{console.log(n,"<item~"),console.log(n.x,"<<item.x"),naver.maps.Event.addListener(a,"click",async t=>{e({type:c.w.SET_ADDRESS_ZOOM,zoom:{x:Number(n.x),y:Number(n.y)-.01}});let{data:s}=await o.Z.get("/v1/search/image.json",{params:{query:n.name,display:5},headers:{"Content-Type":"application/json","X-Naver-Client-Id":"HkmoZuvadMifi4PVKacA","X-Naver-Client-Secret":"3ABiVxxIe8"}});e({type:c.w.SET_IMAGE,image:s.items}),S.current&&(S.current===a||void 0===name)||(a.setIcon({content:'<img src="/img/star.png" style=width:30px />',size:new naver.maps.Size(24,36),origin:new naver.maps.Point(0,0),anchor:new naver.maps.Point(11,35)}),S.current=a,console.log(a),e({type:c.w.SET_PLACE_DETAIL,list:n}),e({type:c.w.SLIDE_MODAL_OPEN,content:"placeDetail",data:n}))})},N=async()=>{};(0,r.useEffect)(()=>{N()},[]);let E=()=>{if(s.length>0){let e={center:new window.naver.maps.LatLng(...[37.5262411,126.99289439]),zoom:13,minZoom:9,scaleControl:!1,mapDataControl:!1,logoControlOptions:{position:naver.maps.Position.BOTTOM_LEFT}},a=new window.naver.maps.Map("map",e),n=[];p.current=a,null==s||s.map((e,t)=>{console.log("gg"),m.current=new window.naver.maps.Marker({map:a,position:new window.naver.maps.LatLng(e.y,e.x),icon:{content:"<p></p>",size:new naver.maps.Size(24,36),origin:new naver.maps.Point(0,0),anchor:new naver.maps.Point(11,35)}}),n.push(e),j(n),w(n)})}};return(0,r.useEffect)(()=>{let e={center:new window.naver.maps.LatLng(...[a.y||37.5262411,a.x||126.99289439]),zoom:13,minZoom:9,scaleControl:!1,mapDataControl:!1,logoControlOptions:{position:naver.maps.Position.BOTTOM_LEFT}},n=new window.naver.maps.Map("map",e);null==g||g.map((e,a)=>{console.log("돈다?"),m.current=new window.naver.maps.Marker({map:n,position:new window.naver.maps.LatLng(e.y||e.position.y,e.x||e.position.x),icon:{content:'<img src="/img/'.concat(h&&i.open?"marker_active":"star",'.png" style=width:30px />'),size:new naver.maps.Size(24,36),origin:new naver.maps.Point(0,0),anchor:new naver.maps.Point(11,35)}}),y(m.current,e)})},[g,S.current]),(0,r.useEffect)(()=>{i.open?h&&j([h]):(j(_),x(null),e({type:c.w.SET_SEARCH_INIT}))},[u.length,h,i]),(0,r.useEffect)(()=>{E()},[s]),(0,r.useEffect)(()=>{if(n.length>0){new window.naver.maps.LatLng(...[a.x,a.y]),naver.maps.Position.BOTTOM_LEFT,naver.maps.Position.TOP_CENTER;let e=p.current;var t=new window.naver.maps.Marker({map:e,position:new window.naver.maps.LatLng(a.y,a.x),icon:{content:'<img src="/img/marker_active.png" style=width:30px />',size:new naver.maps.Size(24,36),origin:new naver.maps.Point(0,0),anchor:new naver.maps.Point(11,35)}});m.current=t,x({...m.current,focus:!0,ico:"marker_active"}),p.current.setCenter(new window.naver.maps.Point(a.x,a.y-.001))}},[a,n]),console.log(h),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{id:"map",className:d().map})})};var v=n(1163),_=n(7762);let w=()=>_.renderToStaticMarkup((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{}),(0,t.jsx)("img",{src:"/img/marker_active.png",style:{width:"20px"}})]}));var h=n(9417),x=n(7814);let g=()=>{var e;let a=(0,l.I0)(),{search:n,slideModal:s}=(0,l.v9)(e=>({search:e.search,slideModal:e.menu.slideModal})),i=e=>{console.log(e,"<<v"),a({type:c.w.POPUP_MODAL_OPEN,content:"confirm",text:"이곳을 맛집으로 <br/> 등록하시겠습니까?",positive:"등록할래요",positiveFn:()=>a({type:c.w.POPUP_MODAL_OPEN,data:e,content:"submit"}),negative:"아뇨"})},r=(e,n)=>{if(a({type:c.w.SET_INDEX,index:e}),!n)return alert("이 주소는 등록되어 있지 않아요");n&&naver.maps.Service.geocode({query:n},(e,n)=>{if(e!==naver.maps.Service.Status.OK)return alert("Something wrong!");let t=n.v2.addresses;a({type:c.w.SET_ADDRESS_ZOOM,zoom:{x:Number(t[0].x),y:Number(t[0].y)}})})};return(0,t.jsxs)("div",{className:"search-list-wrapper",children:[(0,t.jsx)("div",{className:"close-btn",onClick:()=>{a({type:c.w.SLIDE_MODAL_CLOSE})},children:(0,t.jsx)(x.G,{icon:h.g82,fontSize:"20px"})}),(0,t.jsxs)("p",{className:"modal-title",children:["검색결과 (총 ",null==n?void 0:null===(e=n.list)||void 0===e?void 0:e.length,"건)"]}),(0,t.jsx)("div",{className:"list-wrapper",children:null==n?void 0:n.list.map((e,a)=>(0,t.jsxs)("div",{className:"list ".concat(a===n.index?"active":"inactive"),onClick:()=>r(a,e.roadAddress),children:[(0,t.jsx)("p",{className:"title",children:(0,t.jsx)("p",{dangerouslySetInnerHTML:{__html:e.title}})}),(0,t.jsx)("p",{className:"category",children:e.category}),(0,t.jsx)("p",{className:"address",children:e.address}),""!==e.link&&(0,t.jsx)("a",{className:"link",href:"http://www.seoul.go.kr/",children:"바로가기"}),a===n.index&&(0,t.jsx)("button",{onClick:()=>i(e),className:"submit-button",children:"맛집 등록하기"})]}))})]})},j=()=>{let e=(0,l.I0)(),{search:a,slideModal:n,image:s}=(0,l.v9)(e=>({search:e.search,slideModal:e.menu.slideModal,image:e.marker.image}));return(0,t.jsxs)("div",{className:"marker-wrapper",children:[(0,t.jsx)("div",{className:"close-btn",onClick:()=>{e({type:c.w.SLIDE_MODAL_CLOSE})},children:(0,t.jsx)(x.G,{icon:h.g82,fontSize:"20px"})}),(0,t.jsxs)("div",{className:"album",children:[s.map((e,a)=>(0,t.jsx)("div",{className:"img-wrap",children:(0,t.jsx)(i(),{src:"".concat(e.link),width:100,height:100,alt:"이미지 사진",quality:100,loading:"eager"})})),(0,t.jsxs)("div",{className:"marker-info",children:[(0,t.jsx)("p",{className:"title",children:n.data.name.replace("&amp;","&")}),(0,t.jsx)("p",{children:n.data.category}),(0,t.jsx)("p",{children:n.data.address}),(0,t.jsx)("br",{}),(0,t.jsxs)("div",{className:"comment",children:[(0,t.jsx)("p",{children:n.data.comment}),(0,t.jsxs)("p",{children:["작성자: ",n.data.writer]})]})]})]})]})},S=()=>{let{search:e,slideModal:a}=(0,l.v9)(e=>({search:e.search,slideModal:e.menu.slideModal}));return(0,t.jsxs)("div",{className:"slide-modal ".concat(a.open?"active":"inactive"),children:["searchList"===a.content&&(0,t.jsx)(g,{}),"placeDetail"===a.content&&(0,t.jsx)(j,{})]})},y=()=>{let e=(0,l.I0)(),{popupModal:a}=(0,l.v9)(e=>({popupModal:e.menu.popupModal}));return(0,t.jsxs)("div",{className:"confirm-wrap",children:[(0,t.jsx)("p",{className:"text",dangerouslySetInnerHTML:{__html:a.text}}),(0,t.jsx)("span",{}),a.negative&&(0,t.jsxs)("div",{className:"btn-wrap",children:[(0,t.jsx)("button",{onClick:()=>{a.positiveFn()},children:a.positive||"네"}),(0,t.jsx)("button",{onClick:()=>{e({type:c.w.POPUP_MODAL_CLOSE})},children:a.negative})]})]})},N=()=>{let e=(0,l.I0)(),{popupModal:a,zoom:n}=(0,l.v9)(e=>({popupModal:e.menu.popupModal,zoom:e.search.zoom})),[s,i]=(0,r.useState)({writer:null,comment:null}),p=e=>{let{value:a,id:n}=e.target;i({...s,[n]:a})};console.log(s);let m=async()=>{await o.Z.post("/api/insertPlace",{name:a.data.title.replace("<b>","").replace("</b>",""),category:a.data.category,writer:s.writer,comment:s.comment,address:a.data.address,x:n.x,y:n.y}),e({type:c.w.POPUP_MODAL_CLOSE}),e({type:c.w.SLIDE_MODAL_CLOSE});let t=await o.Z.get("/api/insertPlace");console.log(t),e({type:c.w.SET_MARKER,list:t.data})};return(0,t.jsxs)("div",{className:"modal-wrap",children:[(0,t.jsx)("div",{className:"close-btn",children:(0,t.jsx)(x.G,{icon:h.g82,fontSize:"20px",onClick:()=>{e({type:c.w.POPUP_MODAL_CLOSE})}})}),(0,t.jsxs)("div",{className:"submit-wrap",children:[(0,t.jsxs)("div",{className:"form-wrap",children:[(0,t.jsx)("label",{children:"작성자명"}),(0,t.jsx)("input",{placeholder:"ex) 지유",id:"writer",onChange:p})]}),(0,t.jsxs)("div",{className:"form-wrap",children:[(0,t.jsx)("label",{children:"설명"}),(0,t.jsx)("input",{placeholder:"ex) 깔끔하고 분위기 좋은 분식집",id:"comment",onChange:p})]})]}),(0,t.jsx)("div",{className:"btn-wrap",children:(0,t.jsx)("button",{onClick:m,children:"등록하기"})})]})},E=()=>{let{popupModal:e}=(0,l.v9)(e=>({popupModal:e.menu.popupModal}));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"background ".concat(e.open?"active":"inactive")}),(0,t.jsxs)("div",{className:"popup-modal ".concat(e.open?"active":"inactive"),children:["confirm"===e.content&&(0,t.jsx)(y,{}),"submit"===e.content&&(0,t.jsx)(N,{})]})]})},f=()=>{(0,v.useRouter)();let e=(0,l.I0)(),[a,n]=(0,r.useState)(!0),{slideModal:s,popupModal:i}=(0,l.v9)(e=>e.menu);(0,r.useEffect)(()=>{s?n(!1):setTimeout(()=>{n(!0)},1e3)},[s]);let p=async()=>{try{let a=await o.Z.get("/api/insertPlace");console.log(a),e({type:c.w.SET_MARKER,list:a.data}),console.log(" ???")}catch(n){console.log(n)}};return(0,r.useEffect)(()=>{p()},[]),console.log(s.content),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{}),(0,t.jsx)(w,{}),s.open&&(0,t.jsx)(S,{}),i.open&&(0,t.jsx)(E,{})]})},L=()=>{let[e,a]=(0,r.useState)("");return(0,t.jsx)(r.Fragment,{children:(0,t.jsxs)("div",{className:"main-wrap",children:[(0,t.jsx)(p,{setSearchInput:a,searchInput:e}),(0,t.jsx)(f,{})]})})};var O=!0,M=L},7478:function(e){e.exports={header:"map_header__pASHO",logo:"map_logo__NtMpL","input-wrap":"map_input-wrap__YIrMX","search-input":"map_search-input__h22gY","search-button":"map_search-button__8HP9K","slide-modal":"map_slide-modal__uph1Q",active:"map_active__4zDsI","slideup-active-animation":"map_slideup-active-animation__xH_V6",inactive:"map_inactive__KRRxk","slideup-inactive-animation":"map_slideup-inactive-animation__vLieO","popup-modal":"map_popup-modal__9oQSC",background:"map_background__2km_U","popup-background-active-animation":"map_popup-background-active-animation__y5K6X","popup-background-inactive-animation":"map_popup-background-inactive-animation__KwSDk","popup-active-animation":"map_popup-active-animation__9VqQk","popup-inactive-animation":"map_popup-inactive-animation__cBMwr",map:"map_map__dhDH8"}}},function(e){e.O(0,[774,976,41,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);